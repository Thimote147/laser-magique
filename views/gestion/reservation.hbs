<main class="m-0">
    {{#if (eq reservation "Cette réservation n'existe pas")}}
    <section class="container-fluid d-flex justify-content-center align-items-center vh-100">
        <h1>{{reservation}}</h1>
    </section>
    {{else}}
    <section>
        <h1 class="title my-5">Réservation de {{reservation.firstname}}</h1>
        <div class="d-flex">
            <div class="col-5">
                <h5 class="text-decoration-underline">Conso :</h5>
                <div class="ml-4">
                    {{#each reservation.conso}}
                    {{#if (neq reservation.soft "0")}}
                    <p class="m-0">{{quantity}}x {{name}}</p>
                    {{/if}}
                    {{/each}}
                </div>
            </div>
            <div class="col-7">
                <form class="my-2" action="/reservation/add" method="post">
                    <h6 class="text-decoration-underline">Ajouter conso :</h6>
                    <div class="d-flex flex-wrap justify-content-center">
                        <input type="number" name="id" value="{{reservation.id}}" hidden>
                        {{#each stocks}}
                        <button class="btn btn-primary m-1" type="submit" name="choice"
                            value="{{name}}">{{name}}</button>
                        {{/each}}
                    </div>
                </form>
                <form class="my-4" action="/reservation/delete" method="post">
                    <h6 class="text-decoration-underline">Supprimer conso :</h6>
                    <div class="d-flex flex-wrap justify-content-center">
                        <input type="number" name="id" value="{{reservation.id}}" hidden>
                        {{#each reservation.conso}}
                        <button class="btn btn-primary m-1" type="submit" name="choice"
                            value="{{name}}">{{name}}</button>
                        {{/each}}
                    </div>
                </form>
            </div>
        </div>
        <div class="d-flex">
            <div class="col-5">
                <h5 class="text-decoration-underline">Parties :</h5>
                <div class="ml-4">
                    {{#if (neq reservation.nbr_laser "0")}}
                    <p class="m-0">{{reservation.nbr_laser}}x Laser Game</p>
                    {{/if}}
                    {{#if (neq reservation.nbr_vr "0")}}
                    <p class="m-0">{{reservation.nbr_vr}}x Réalité Virtuelle</p>
                    {{/if}}
                    {{#if (neq reservation.nbr_ct "0")}}
                    <p class="m-0">{{reservation.nbr_ct}}x Cyber Trike</p>
                    {{/if}}
                </div>
            </div>
            <div class="col-7">
                <form action="/reservation/add" method="post">
                    <h6 class="text-decoration-underline">Ajouter parties :</h6>
                    <div class="d-flex flex-wrap justify-content-center">
                        <input type="number" name="id" value="{{reservation.id}}" hidden>
                        <input type="number" name="persons" value="{{reservation.persons}}" hidden>
                        <button class="btn btn-primary m-1" type="submit" name="choice" value="laser">Laser
                            Game</button>
                        <button class="btn btn-primary m-1" type="submit" name="choice" value="vr">Réalité
                            Virtuelle</button>
                        <button class="btn btn-primary m-1" type="submit" name="choice" value="ct">Cyber Trike</button>
                    </div>
                </form>
                <form class="my-4" action="/reservation/delete" method="post">
                    <h6 class="text-decoration-underline">Supprimer parties :</h6>
                    <div class="d-flex flex-wrap justify-content-center">
                        <input type="number" name="id" value="{{reservation.id}}" hidden>
                        <input type="number" name="persons" value="{{reservation.persons}}" hidden>
                        {{#if (eq reservation.nbr_laser "0")}}
                        <button class="btn btn-secondary m-1" disabled="disabled">Laser Game</button>
                        {{else}}
                        <button class="btn btn-primary m-1" type="submit" name="choice" value="laser">Laser
                            Game</button>
                        {{/if}}
                        {{#if (eq reservation.nbr_vr "0")}}
                        <button class="btn btn-secondary m-1" disabled="disabled">Réalité Virtuelle</button>
                        {{else}}
                        <button class="btn btn-primary m-1" type="submit" name="choice" value="vr">Réalité
                            Virtuelle</button>
                        {{/if}}
                        {{#if (eq reservation.nbr_ct "0")}}
                        <button class="btn btn-secondary m-1" disabled="disabled">Cyber Trike</button>
                        {{else}}
                        <button class="btn btn-primary m-1" type="submit" name="choice" value="ct">Cyber Trike</button>
                        {{/if}}
                    </div>
                </form>
            </div>
        </div>
    </section>
    <section id="details" class="m-3 text-white">
        <h3 class="text-decoration-underline">Détails :</h3>
        <form class="col-12 col-md-6" action="/reservation/update_infos" method="post">
            <div class="d-flex justify-content-between">
                <label for="persons">Personnes : </label>
                <input type="number" inputmode="numeric" name="persons" value="{{reservation.persons}}" min="2">
            </div>
            {{#if session.member.is_admin}}
            <div class="d-flex justify-content-between">
                <label for="date">Date : </label>
                <input type="datetime-local" name="date" value="{{reservation.date}}">
            </div>
            {{else}}
            <div class="d-flex justify-content-between">
                <label for="hour">Heure : </label>
                <input type="text" name="hour" value="{{reservation.hour}}" hidden>
                <p>{{reservation.hour}}</p>
            </div>
            {{/if}}
            <div class="d-flex justify-content-between">
                <label for="activities">Activités : </label>
                <select name="activities" class="select-size-modal">
                    <optgroup label="Nos Jeux">
                        {{#if (eq reservation.activities "Laser Game")}}
                        <option value="Laser Game" selected>Laser Game
                        </option>
                        {{else}}
                        <option value="Laser Game">Laser Game</option>
                        {{/if}}
                        {{#if (eq reservation.activities "Réalité Virtuelle")}}
                        <option value="Réalité Virtuelle" selected>
                            Réalité Virtuelle
                        </option>
                        {{else}}
                        <option value="Réalité Virtuelle">Réalité Virtuelle
                        </option>
                        {{/if}}
                        {{#if (eq reservation.activities "Cyber Games")}}
                        <option value="Cyber Games" selected>Cyber Games
                        </option>
                        {{else}}
                        <option value="Cyber Games">Cyber Games</option>
                        {{/if}}
                    </optgroup>
                    <optgroup label="Nos Packs">
                        {{#if (eq reservation.activities "Anniversaire Laser Game")}}
                        <option value="Anniversaire Laser Game" selected>
                            Anniversaire Laser Game
                        </option>
                        {{else}}
                        <option value="Anniversaire Laser Game">
                            Anniversaire Laser Game
                        </option>
                        {{/if}}
                        {{#if (eq reservation.activities "Anniversaire Trio Pack")}}
                        <option value="Anniversaire Trio Pack" selected>
                            Anniversaire Trio Pack
                        </option>
                        {{else}}
                        <option value="Anniversaire Trio Pack">
                            Anniversaire Trio Pack
                        </option>
                        {{/if}}
                        {{#if (eq reservation.activities "Famille Trio Pack")}}
                        <option value="Famille Trio Pack" selected>
                            Famille Trio Pack
                        </option>
                        {{else}}
                        <option value="Famille Trio Pack">Famille Trio Pack
                        </option>
                        {{/if}}
                    </optgroup>
                    <optgroup label="Nos Combinaisons">
                        {{#if (eq reservation.activities
                        "Laser Game + Réalité Virtuelle")}}
                        <option value="Laser Game + Réalité Virtuelle" selected>
                            Laser Game + Réalité Virtuelle
                        </option>
                        {{else}}
                        <option value="Laser Game + Réalité Virtuelle">
                            Laser Game + Réalité Virtuelle
                        </option>
                        {{/if}}
                        {{#if (eq reservation.activities "Laser Game + Cyber Games")}}
                        <option value="Laser Game + Cyber Games" selected>
                            Laser Game + Cyber Games
                        </option>
                        {{else}}
                        <option value="Laser Game + Cyber Games">
                            Laser Game + Cyber Games
                        </option>
                        {{/if}}
                        {{#if (eq reservation.activities
                        "Réalité Virtuelle + Cyber Games")}}
                        <option value="Réalité Virtuelle + Cyber Games" selected>
                            Réalité Virtuelle + Cyber Games
                        </option>
                        {{else}}
                        <option value="Réalité Virtuelle + Cyber Games">
                            Réalité Virtuelle + Cyber Games
                        </option>
                        {{/if}}
                        {{#if (eq reservation.activities
                        "Laser Game + Réalité Virtuelle + Cyber Games")}}
                        <option value="Laser Game + Réalité Virtuelle + Cyber Games" selected>
                            Laser Game + Réalité Virtuelle + Cyber Games
                        </option>
                        {{else}}
                        <option value="Laser Game + Réalité Virtuelle + Cyber Games">
                            Laser Game + Réalité Virtuelle + Cyber Games
                        </option>
                        {{/if}}
                    </optgroup>
                </select>
            </div>
            <input type="hidden" name="nbr_laser" value="{{reservation.nbr_laser}}">
            <input type="hidden" name="nbr_vr" value="{{reservation.nbr_vr}}">
            <input type="hidden" name="nbr_ct" value="{{reservation.nbr_ct}}">
            <input type="hidden" name="conso" value="{{reservation.conso_id}}">
            <div class="d-flex justify-content-between">
                <label for="deposit">Accompte :</label>
                <input type="number" name="deposit" value="{{reservation.deposit}}" min="0">
            </div>
            <div class="d-flex justify-content-between">
                <label for="payment_bcc">Payé par Bcc : </label>
                <input type="text" inputmode="decimal" name="payment_bcc" value="{{reservation.payment_bcc}}" min="0"
                    step="0.5">
            </div>
            <div class="d-flex justify-content-between">
                <label for="payment_cash">Payé par Cash : </label>
                <input type="text" inputmode="decimal" name="payment_cash" value="{{reservation.payment_cash}}" min="0"
                    step="0.5">
            </div>
            <div class="d-flex justify-content-between">
                <label for="payment_by">Payé en : </label>
                <select type="text" name="payment_by">
                    {{#if (eq reservation.payment_by "")}}
                    <option value="" selected>/</option>
                    {{else}}
                    <option value="">/</option>
                    {{/if}}
                    {{#if (eq reservation.payment_by "Bcc")}}
                    <option value="Bcc" selected>Bcc</option>
                    {{else}}
                    <option value="Bcc">Bcc</option>
                    {{/if}}
                    {{#if (eq reservation.payment_by "Cash")}}
                    <option value="Cash" selected>Cash</option>
                    {{else}}
                    <option value="Cash">Cash</option>
                    {{/if}}
                    {{#if (eq reservation.payment_by "Bcc/Cash")}}
                    <option value="Bcc/Cash" selected>Bcc &amp; Cash
                    </option>
                    {{else}}
                    <option value="Bcc/Cash">Bcc &amp; Cash</option>
                    {{/if}}
                    {{#if (eq reservation.payment_by "Social Deal")}}
                    <option value="Social Deal" selected>Social Deal
                    </option>
                    {{else}}
                    <option value="Social Deal">Social Deal</option>
                    {{/if}}
                </select>
            </div>
            <div class="d-flex justify-content-between">
                <label for="observation">Observations : </label>
                <textarea name="observation" cols="20" rows="5">{{reservation.observation}}</textarea>
            </div>

            <p>Restant à payer : {{reservation.remaining}}€</p>
            <p>Total à payer : {{reservation.total}}€</p>

            <button class="btn btn-primary" type="submit" name="id" value="{{reservation.id}}">Enregistrer</button>
        </form>
    </section>
    {{/if}}
</main>